# AstroBot - Personalized Astrology Web Application

## Overview

AstroBot is a full-stack web application that provides personalized astrology insights, daily horoscopes, AI-powered guidance, and cosmic music curation. The application allows users to create detailed astrological profiles based on their birth data, interact with an AI chatbot for astrological advice, and generate personalized music playlists that align with their daily astrological moods.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

### Frontend Architecture
- **Framework**: React with TypeScript
- **Build Tool**: Vite for development and building
- **UI Framework**: Shadcn/UI components built on Radix UI primitives
- **Styling**: Tailwind CSS with custom cosmic/mystical color schemes
- **State Management**: TanStack Query (React Query) for server state management
- **Routing**: Wouter for client-side routing
- **Form Handling**: React Hook Form with Zod validation

### Backend Architecture
- **Runtime**: Node.js with Express.js server
- **Language**: TypeScript with ES modules
- **Authentication**: Replit Auth integration with session management
- **Database**: PostgreSQL with Drizzle ORM
- **Session Storage**: PostgreSQL-backed sessions using connect-pg-simple

### Database Design
The application uses PostgreSQL with the following key tables:
- **users**: Stores user profile data including birth information and calculated astrological data (sun/moon/rising signs)
- **sessions**: Required for Replit Auth session management
- **chatMessages**: Stores AI chat conversation history
- **horoscopes**: Stores generated daily horoscope content
- **cosmicPlaylists**: Stores AI-generated music playlists with astrological context and track recommendations

## Key Components

### Authentication System
- Replit Auth integration for secure user authentication
- Session-based authentication with PostgreSQL storage
- Mandatory user operations for Replit Auth compatibility
- Automatic redirect handling for unauthorized access

### Astrological Services
- Birth chart calculation service (simplified implementation, can be enhanced with proper astronomical APIs)
- Daily horoscope generation using OpenAI integration
- Astrological data processing and storage

### AI Chat System ✅ ENHANCED  
- OpenAI GPT-4o integration for deep astrological analysis
- Advanced birth chart interpretation with current transit analysis
- Synastry compatibility analysis for relationship insights
- Transit timing analysis for specific date ranges
- Context-aware responses using complete natal chart data
- Professional-level astrological consultation capabilities
- Chat history persistence and retrieval
- ✅ Chat transcript saving to journal with full conversation history
- ✅ Individual AI insight saving for specific valuable responses
- ✅ Formatted chat exports with timestamps and reflection prompts
- ✅ Interactive tag cloud navigation with frequency-based sizing and filtering
- ✅ Mood-based journal entry footer links for mood-based filtering functionality
- ✅ Combined tag and mood filtering with case-insensitive PostgreSQL array search
- ✅ Clear filter buttons for individual and combined filter management

### Dynamic Cosmic Energy Color Palette System ✅ COMPLETED
- Real-time personalized color themes that evolve with user's cosmic journey
- Element-based base palettes (fire, earth, air, water signs get distinct color schemes)
- Sun sign determines primary color palette foundation
- Moon sign influences secondary color harmonies and emotional undertones
- Current moon phase affects brightness, saturation, and overall energy intensity
- Mood-based color adjustments when users interact with journal mood badges
- Cosmic palette indicator component showing current personalized color scheme
- CSS variable system enabling dynamic theme changes throughout entire application
- Planetary influence integration for authentic astrological color associations
- Real-time palette updates responding to user interactions and cosmic conditions

### Cosmic Playlist Generator ✅ COMPLETED
- AI-powered music curation using OpenAI GPT-4o integration
- Personalized playlists based on Sun, Moon, and Rising sign combinations
- Daily astrological mood analysis with planetary influence tracking
- Individual track recommendations with detailed astrological reasoning
- Genre suggestions and energy level categorization (high/medium/low)
- Playlist history storage and retrieval functionality
- Beautiful cosmic-themed interface with interactive track details
- Integration with main navigation and user authentication system
- ✅ Spotify export functionality with automatic token refresh
- ✅ Journal integration with clickable Spotify playlist links
- ✅ Database storage of Spotify URLs for exported playlists

### Personalized Lunar Energy Recommendation Engine ✅ COMPLETED
- AI-powered personalized lunar energy analysis using OpenAI GPT-4o integration
- Real-time moon phase and astrological sign calculations
- Personalized recommendations based on user's Sun, Moon, and Rising signs
- Daily guidance, manifestation focus, and wellness activities
- Crystal and color recommendations aligned with user's chart
- Self-care rituals customized for individual astrological makeup
- Beautiful cosmic-themed interface in Moon Calendar tab
- ✅ Journal integration with "Add Lunar Insights" functionality
- ✅ API endpoint `/api/moon/energy-recommendations` for personalized insights
- ✅ Enhanced ritual personalization with user-specific AI generation
- ✅ Database integration with personalized ritual storage system

### UI/UX Features
- Dark theme with cosmic/mystical color palette
- Responsive design for mobile and desktop
- Component-based architecture using Shadcn/UI
- Loading states and error handling throughout the application

## Data Flow

1. **User Registration/Login**: Uses Replit Auth for secure authentication
2. **Profile Setup**: Users input birth data which triggers astrological calculations
3. **Dashboard**: Displays personalized horoscope, birth chart summary, and astrological tools
4. **Chat Interface**: Users interact with AI for astrological guidance
5. **Cosmic Playlist Generator**: AI analyzes user's astrological profile to create personalized music recommendations
6. **Lunar Energy Engine**: AI generates personalized daily lunar energy recommendations based on current moon phase and user's natal chart
7. **Astro Journal Integration**: Comprehensive journaling system with cross-feature integration allowing users to save content from any tab (chat transcripts, lunar insights, playlist experiences)
8. **Dynamic Cosmic Energy Color Palette System**: Real-time personalized color themes based on astrological data, moon phases, and mood selections
9. **Data Persistence**: All user data, chat messages, horoscopes, cosmic playlists, moon rituals, lunar energy insights, and journal entries are stored in PostgreSQL

## External Dependencies

### Core Dependencies
- **@neondatabase/serverless**: PostgreSQL database connection
- **drizzle-orm**: Type-safe ORM for database operations
- **openai**: AI chat functionality
- **express**: Web server framework
- **@tanstack/react-query**: Server state management

### UI Dependencies  
- **@radix-ui/***: Accessible UI primitives
- **tailwindcss**: Utility-first CSS framework
- **react-hook-form**: Form handling
- **zod**: Schema validation

### Development Dependencies
- **vite**: Build tool and development server
- **typescript**: Type safety
- **drizzle-kit**: Database migrations and schema management

## Deployment Strategy

### Build Process
- Frontend: Vite builds React application to `dist/public`
- Backend: esbuild bundles Express server to `dist/index.js`
- Database: Drizzle migrations manage schema changes

### Environment Configuration
- **DATABASE_URL**: PostgreSQL connection string (required)
- **OPENAI_API_KEY**: OpenAI API access (required for chat functionality)
- **SESSION_SECRET**: Session encryption secret (required)
- **REPLIT_DOMAINS**: Required for Replit Auth
- **ISSUER_URL**: OIDC configuration for Replit Auth

### Production Considerations
- The application is configured for Replit hosting with specific plugins
- Uses PostgreSQL for both application data and session storage
- Implements proper error handling and logging
- Includes development-specific middleware that's conditionally loaded

The architecture prioritizes type safety, user experience, and scalable data management while providing a solid foundation for astrological content delivery and AI-powered user interactions.